<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ohm's Law - Interactive Physics</title>
    <link rel="stylesheet" href="parallax-style.css">
    <style>
        /* Enhanced Ohm's Law Visualization Styles */
        :root {
            --voltage-color: #e74c3c;
            --current-color: #f39c12;
            --resistance-color: #9b59b6;
            --power-color: #2ecc71;
            --law-color: #3498db;
        }

        .illustration-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            color: white;
        }

        .concept-section {
            margin: 60px 0;
            background: rgba(0, 5, 17, 0.8);
            border-radius: 20px;
            padding: 40px;
            border: 2px solid rgba(74, 158, 255, 0.3);
            backdrop-filter: blur(15px);
        }

        .section-title {
            font-size: 2.5rem;
            color: #4a9eff;
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #4a9eff, #74b9ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Interactive Ohm's Law Calculator */
        .ohms-calculator {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(74, 158, 255, 0.3);
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .variable-control {
            background: rgba(74, 158, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(74, 158, 255, 0.3);
        }

        .variable-label {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .voltage-control .variable-label { color: var(--voltage-color); }
        .current-control .variable-label { color: var(--current-color); }
        .resistance-control .variable-label { color: var(--resistance-color); }

        .control-slider {
            width: 100%;
            height: 12px;
            border-radius: 6px;
            margin: 20px 0;
            position: relative;
            cursor: pointer;
        }

        .voltage-slider { background: linear-gradient(90deg, #3498db, var(--voltage-color)); }
        .current-slider { background: linear-gradient(90deg, #3498db, var(--current-color)); }
        .resistance-slider { background: linear-gradient(90deg, #2ecc71, var(--resistance-color)); }

        .control-thumb {
            position: absolute;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            top: -6px;
            cursor: grab;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 3px solid;
            transition: transform 0.2s ease;
        }

        .voltage-thumb { border-color: var(--voltage-color); }
        .current-thumb { border-color: var(--current-color); }
        .resistance-thumb { border-color: var(--resistance-color); }

        .control-thumb:hover {
            transform: scale(1.1);
        }

        .value-display {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        /* Circuit Visualization */
        .circuit-demo {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 400px;
            margin: 30px auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            border: 2px solid rgba(74, 158, 255, 0.3);
        }

        .circuit-wire {
            position: absolute;
            background: #ffeaa7;
            border-radius: 3px;
            box-shadow: 0 0 10px rgba(255, 234, 167, 0.5);
        }

        .wire-h { height: 8px; }
        .wire-v { width: 8px; }

        .wire-top { width: 400px; top: 80px; left: 200px; }
        .wire-bottom { width: 400px; top: 280px; left: 200px; }
        .wire-left { height: 200px; left: 200px; top: 80px; }
        .wire-right { height: 200px; right: 200px; top: 80px; }

        .circuit-battery {
            position: absolute;
            width: 80px;
            height: 40px;
            background: linear-gradient(90deg, #2c3e50, #34495e);
            border-radius: 8px;
            left: 100px;
            top: 50%;
            transform: translateY(-50%);
            border: 3px solid var(--voltage-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .circuit-resistor {
            position: absolute;
            width: 80px;
            height: 20px;
            background: repeating-linear-gradient(45deg, #8b4513, #8b4513 8px, #daa520 8px, #daa520 16px);
            right: 100px;
            top: 50%;
            transform: translateY(-50%);
            border-radius: 5px;
            border: 2px solid #654321;
        }

        .current-flow {
            position: absolute;
            width: 16px;
            height: 16px;
            background: radial-gradient(circle, var(--current-color), #e67e22);
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(243, 156, 18, 0.8);
            opacity: 0;
            animation: currentFlow var(--flow-duration, 4s) ease-in-out infinite;
        }

        @keyframes currentFlow {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        .current-top { animation-name: flowTop; }
        .current-right { animation-name: flowRight; }
        .current-bottom { animation-name: flowBottom; }
        .current-left { animation-name: flowLeft; }

        @keyframes flowTop {
            0% { left: 200px; top: 72px; opacity: 0; }
            25% { left: 400px; top: 72px; opacity: 1; }
            50% { left: 592px; top: 72px; opacity: 1; }
            75% { left: 592px; top: 72px; opacity: 1; }
            100% { left: 592px; top: 72px; opacity: 0; }
        }

        @keyframes flowRight {
            0% { left: 584px; top: 80px; opacity: 0; }
            25% { left: 584px; top: 180px; opacity: 1; }
            50% { left: 584px; top: 280px; opacity: 1; }
            75% { left: 584px; top: 280px; opacity: 1; }
            100% { left: 584px; top: 280px; opacity: 0; }
        }

        @keyframes flowBottom {
            0% { left: 592px; top: 272px; opacity: 0; }
            25% { left: 400px; top: 272px; opacity: 1; }
            50% { left: 200px; top: 272px; opacity: 1; }
            75% { left: 200px; top: 272px; opacity: 1; }
            100% { left: 200px; top: 272px; opacity: 0; }
        }

        @keyframes flowLeft {
            0% { left: 192px; top: 280px; opacity: 0; }
            25% { left: 192px; top: 180px; opacity: 1; }
            50% { left: 192px; top: 80px; opacity: 1; }
            75% { left: 192px; top: 80px; opacity: 1; }
            100% { left: 192px; top: 80px; opacity: 0; }
        }

        /* Formula Display */
        .formula-triangle {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 30px auto;
            background: linear-gradient(135deg, rgba(74, 158, 255, 0.2), rgba(116, 185, 255, 0.1));
            border: 3px solid var(--law-color);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .formula-triangle:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(74, 158, 255, 0.3);
        }

        .triangle-content {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: var(--law-color);
        }

        .formula-variations {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .formula-card {
            background: rgba(74, 158, 255, 0.1);
            border: 2px solid rgba(74, 158, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .formula-card:hover {
            transform: translateY(-5px);
            border-color: var(--law-color);
        }

        .formula-eq {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }

        .voltage-formula { color: var(--voltage-color); }
        .current-formula { color: var(--current-color); }
        .resistance-formula { color: var(--resistance-color); }

        .animate-btn {
            background: linear-gradient(135deg, #4a9eff, #74b9ff);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(74, 158, 255, 0.3);
        }

        .animate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 158, 255, 0.4);
        }

        .results-display {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid rgba(74, 158, 255, 0.3);
        }

        .result-row {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.8s ease forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-delay-1 { animation-delay: 0.2s; }
        .animate-delay-2 { animation-delay: 0.4s; }
        .animate-delay-3 { animation-delay: 0.6s; }

        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
            
            .circuit-demo {
                height: 300px;
            }
            
            .wire-top, .wire-bottom {
                width: 300px;
                left: 150px;
            }
            
            .wire-left, .wire-right {
                height: 150px;
            }
            
            .formula-variations {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Cinematic Experience Container -->
    <div id="cinematic-experience">
        
        <!-- Loading Screen -->
        <div id="loading-screen" class="active">
            <div class="loading-content">
                <div class="atom-spinner">
                    <div class="nucleus"></div>
                    <div class="electron-orbit orbit-1">
                        <div class="electron"></div>
                    </div>
                    <div class="electron-orbit orbit-2">
                        <div class="electron"></div>
                    </div>
                    <div class="electron-orbit orbit-3">
                        <div class="electron"></div>
                    </div>
                </div>
                <h1>Ohm's Law</h1>
                <p>Loading electrical relationships...</p>
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
            </div>
        </div>

        <!-- Fixed Elements -->
        <!-- Audio Control -->
        <div id="audio-control">
            <button id="mute-btn" class="control-btn">
                <span class="unmute-icon">🔊</span>
                <span class="mute-icon">🔇</span>
            </button>
        </div>

        <!-- Main Content Container -->
        <div id="main-content">
            
            <!-- Hero Section -->
            <section class="cinematic-section active" style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
                <div class="section-background" style="background: radial-gradient(ellipse at center, #1e3d59 0%, #000511 60%, #000204 100%); opacity: 1;"></div>
                
                <div class="narrative-overlay" style="position: relative; z-index: 10; text-align: center;">
                    <div class="section-indicator" style="margin-bottom: 30px;">
                        <span class="section-number">⚡</span>
                        <span class="section-title">Ohm's Law</span>
                    </div>
                    <div class="narrative-content">
                        <h1 style="font-size: 3.5rem; margin-bottom: 30px; background: linear-gradient(45deg, #3498db, #e74c3c, #f39c12); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">V = I × R</h1>
                        <p class="narrative-text" style="font-size: 1.3rem; max-width: 800px; margin: 0 auto 40px;">
                            Ohm's Law describes the fundamental relationship between voltage, current, and resistance in electrical circuits. 
                            Master this law to understand all electrical phenomena.
                        </p>
                        <div class="equation-display" style="font-size: 1.5rem; color: #3498db;">The Foundation of Electrical Engineering</div>
                    </div>
                </div>

                <div class="scroll-hint" style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); text-align: center; color: #3498db; animation: bounce 2s infinite;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">↓</div>
                    <p>Scroll to explore Ohm's Law</p>
                </div>
            </section>

            <!-- Main Educational Content -->
            <div class="illustration-container">

                <!-- Section 1: Understanding Ohm's Law -->
                <div class="concept-section fade-in">
                    <h2 class="section-title">Understanding Ohm's Law</h2>
                    
                    <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 30px; text-align: center;">
                        Ohm's Law states that the current through a conductor is directly proportional to the voltage 
                        across it and inversely proportional to its resistance.
                    </p>

                    <div class="formula-triangle" onclick="explainFormula()">
                        <div class="triangle-content">
                            V = I × R
                        </div>
                    </div>

                    <div class="formula-variations">
                        <div class="formula-card">
                            <h4>Voltage</h4>
                            <div class="formula-eq voltage-formula">V = I × R</div>
                            <p>Voltage equals Current times Resistance</p>
                        </div>
                        
                        <div class="formula-card">
                            <h4>Current</h4>
                            <div class="formula-eq current-formula">I = V ÷ R</div>
                            <p>Current equals Voltage divided by Resistance</p>
                        </div>
                        
                        <div class="formula-card">
                            <h4>Resistance</h4>
                            <div class="formula-eq resistance-formula">R = V ÷ I</div>
                            <p>Resistance equals Voltage divided by Current</p>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Interactive Calculator -->
                <div class="concept-section fade-in animate-delay-1">
                    <h2 class="section-title">Interactive Ohm's Law Calculator</h2>
                    
                    <div class="ohms-calculator">
                        <p style="text-align: center; margin-bottom: 30px; font-size: 1.1rem;">
                            Adjust any two values to automatically calculate the third using Ohm's Law
                        </p>

                        <div class="calculator-grid">
                            <div class="variable-control voltage-control">
                                <div class="variable-label">Voltage (V)</div>
                                <div class="control-slider voltage-slider" onclick="adjustVoltage(event)">
                                    <div class="control-thumb voltage-thumb" id="voltage-thumb"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #bbb;">
                                    <span>0V</span>
                                    <span>24V</span>
                                </div>
                                <div class="value-display" id="voltage-display" style="color: var(--voltage-color);">12.0 V</div>
                            </div>

                            <div class="variable-control current-control">
                                <div class="variable-label">Current (I)</div>
                                <div class="control-slider current-slider" onclick="adjustCurrent(event)">
                                    <div class="control-thumb current-thumb" id="current-thumb"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #bbb;">
                                    <span>0A</span>
                                    <span>5A</span>
                                </div>
                                <div class="value-display" id="current-display" style="color: var(--current-color);">1.0 A</div>
                            </div>

                            <div class="variable-control resistance-control">
                                <div class="variable-label">Resistance (R)</div>
                                <div class="control-slider resistance-slider" onclick="adjustResistance(event)">
                                    <div class="control-thumb resistance-thumb" id="resistance-thumb"></div>
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #bbb;">
                                    <span>1Ω</span>
                                    <span>100Ω</span>
                                </div>
                                <div class="value-display" id="resistance-display" style="color: var(--resistance-color);">12.0 Ω</div>
                            </div>
                        </div>

                        <div class="results-display">
                            <div class="result-row">
                                <span style="color: var(--voltage-color);">Voltage: <span id="result-voltage">12.0 V</span></span>
                                <span style="color: var(--current-color);">Current: <span id="result-current">1.0 A</span></span>
                                <span style="color: var(--resistance-color);">Resistance: <span id="result-resistance">12.0 Ω</span></span>
                            </div>
                            <div class="result-row">
                                <span style="color: var(--power-color);">Power: <span id="result-power">12.0 W</span></span>
                                <span style="color: var(--law-color);">Formula Used: <span id="formula-used">V = I × R</span></span>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 30px 0;">
                        <button class="animate-btn" onclick="demonstrateOhmsLaw()">▶ Auto Demo (D)</button>
                        <button class="animate-btn" onclick="resetCalculator()">↻ Reset (R)</button>
                        <button class="animate-btn" onclick="showCircuit()">🔌 Show Circuit</button>
                        <br><br>
                        <button class="animate-btn" onclick="setLowVoltage()" style="background: linear-gradient(135deg, #3498db, #2980b9);">3V - LED</button>
                        <button class="animate-btn" onclick="setMediumVoltage()" style="background: linear-gradient(135deg, #f39c12, #e67e22);">12V - Auto</button>
                        <button class="animate-btn" onclick="setHighVoltage()" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">24V - Industrial</button>
                    </div>

                    <div style="background: rgba(74, 158, 255, 0.1); border-radius: 10px; padding: 15px; margin: 20px 0; font-size: 0.9rem; text-align: center;">
                        <strong>Keyboard Controls:</strong> ↑↓ Current | Shift+↑↓ Voltage | ←→ Resistance | R Reset | D Demo | S Start Flow
                    </div>
                </div>

                <!-- Section 3: Circuit Visualization -->
                <div class="concept-section fade-in animate-delay-2">
                    <h2 class="section-title">Circuit Visualization</h2>
                    
                    <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 30px; text-align: center;">
                        See how voltage, current, and resistance interact in a real circuit. 
                        The current flow speed changes based on your Ohm's Law calculations.
                    </p>

                    <div class="circuit-demo">
                        <!-- Circuit wires -->
                        <div class="circuit-wire wire-h wire-top"></div>
                        <div class="circuit-wire wire-h wire-bottom"></div>
                        <div class="circuit-wire wire-v wire-left"></div>
                        <div class="circuit-wire wire-v wire-right"></div>
                        
                        <!-- Circuit components -->
                        <div class="circuit-battery" id="circuit-battery">12V</div>
                        <div class="circuit-resistor" id="circuit-resistor"></div>
                        
                        <!-- Current flow animation -->
                        <div class="current-flow current-top" style="animation-delay: 0s;"></div>
                        <div class="current-flow current-right" style="animation-delay: 1s;"></div>
                        <div class="current-flow current-bottom" style="animation-delay: 2s;"></div>
                        <div class="current-flow current-left" style="animation-delay: 3s;"></div>
                        
                        <!-- Labels -->
                        <div style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); color: #3498db; font-weight: 600;">
                            Interactive Circuit Simulation
                        </div>
                        <div style="position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(74, 158, 255, 0.9); color: white; padding: 8px 15px; border-radius: 15px;" id="circuit-status">
                            Current Flow: 1.0 A
                        </div>
                    </div>

                    <div style="text-align: center; margin: 30px 0;">
                        <button class="animate-btn" onclick="startCurrentFlow()">⚡ Start Current Flow (S)</button>
                        <button class="animate-btn" onclick="stopCurrentFlow()">⏹ Stop Flow</button>
                        <button class="animate-btn" onclick="toggleFlowSpeed()">🏃 Toggle Speed</button>
                        <br><br>
                        <button class="animate-btn" onclick="explainFormula()" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">📚 Explain Formula</button>
                        <button class="animate-btn" onclick="speakCircuitAnalysis()" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">🎤 Circuit Analysis</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Enhanced Script -->
    <script>
        // Initialize the experience
        window.addEventListener('load', () => {
            setTimeout(() => {
                hideLoadingScreen();
                initializeAnimations();
                initializeVoiceSystem();
                setupCalculator();
                setupSliderInteractions();
            }, 2000);
        });

        // Standardized Humanistic Voice System
        class HumanisticVoice {
            constructor() {
                this.isEnabled = true;
                this.currentUtterance = null;
                this.preferredVoice = null;
                this.settings = {
                    rate: 0.85,        // Slightly slower for better comprehension
                    pitch: 1.0,        // Natural pitch
                    volume: 0.9        // Clear but not overwhelming
                };
                this.initializeVoices();
            }

            initializeVoices() {
                // Wait for voices to load
                if (speechSynthesis.getVoices().length === 0) {
                    speechSynthesis.onvoiceschanged = () => {
                        this.selectPreferredVoice();
                    };
                } else {
                    this.selectPreferredVoice();
                }
            }

            selectPreferredVoice() {
                const voices = speechSynthesis.getVoices();
                
                // Priority order for premium British female voices (most natural sounding)
                const preferredVoiceNames = [
                    'Serena',                    // Premium British English female
                    'Kate',                      // High-quality British English
                    'Stephanie',                 // British English female
                    'Emma',                      // British English female  
                    'Amy',                       // British English female
                    'British English Female',    // Generic British female
                    'English (UK) Female',       // UK female variant
                    'Google UK English Female',  // Google's British voice
                    'Microsoft Hazel',           // Microsoft UK voice
                    'Daniel (Enhanced)',         // Enhanced British male as backup
                    'Moira',                     // Irish English (close alternative)
                    'Fiona',                     // Scottish English female
                    'Samantha',                  // macOS natural voice (backup)
                    'Karen',                     // Natural sounding (backup)
                    'Alex',                      // Good for education (backup)
                    'Google US English',         // Google's neural voice (backup)
                    'Microsoft Zira',            // Microsoft natural voice (backup)
                    'Microsoft David'            // Final backup option
                ];

                // Try to find preferred voices first - prioritizing British female voices
                for (const voiceName of preferredVoiceNames) {
                    const voice = voices.find(v => 
                        v.name.toLowerCase().includes(voiceName.toLowerCase()) && 
                        (v.lang.includes('en-GB') || v.lang.includes('en-UK') || v.lang.includes('en'))
                    );
                    if (voice) {
                        this.preferredVoice = voice;
                        console.log(`🎤 Selected premium voice: ${voice.name} (${voice.lang})`);
                        return;
                    }
                }

                // Enhanced fallback to any high-quality English voice with British preference
                this.preferredVoice = voices.find(voice => {
                    const name = voice.name.toLowerCase();
                    const lang = voice.lang.toLowerCase();
                    return (lang.includes('en-gb') || lang.includes('en-uk')) && 
                           (name.includes('female') || name.includes('woman') || 
                            name.includes('premium') || name.includes('enhanced') || 
                            name.includes('natural') || !name.includes('compact'));
                }) || voices.find(voice => {
                    const name = voice.name.toLowerCase();
                    return voice.lang.includes('en') && 
                           (name.includes('premium') || name.includes('enhanced') || 
                            name.includes('natural') || name.includes('female') ||
                            !name.includes('compact'));
                }) || voices.find(voice => voice.lang.includes('en')) || voices[0];

                if (this.preferredVoice) {
                    console.log(`🎤 Using voice: ${this.preferredVoice.name} (${this.preferredVoice.lang})`);
                }
            }

            speak(text, options = {}) {
                if (!this.isEnabled || !text || !('speechSynthesis' in window)) {
                    return;
                }

                // Stop any current speech
                this.stop();

                // Create utterance with humanistic settings
                const utterance = new SpeechSynthesisUtterance(text);
                
                // Apply settings
                utterance.rate = options.rate || this.settings.rate;
                utterance.pitch = options.pitch || this.settings.pitch;
                utterance.volume = options.volume || this.settings.volume;
                
                // Set preferred voice
                if (this.preferredVoice) {
                    utterance.voice = this.preferredVoice;
                }

                // Event handlers for better user experience
                utterance.onstart = () => {
                    console.log('🎤 Speaking:', text.substring(0, 50) + '...');
                    this.showAudioIndicator();
                };

                utterance.onend = () => {
                    this.currentUtterance = null;
                    this.hideAudioIndicator();
                };

                utterance.onerror = (event) => {
                    console.error('Speech synthesis error:', event.error);
                    this.currentUtterance = null;
                    this.hideAudioIndicator();
                };

                // Store current utterance and speak
                this.currentUtterance = utterance;
                speechSynthesis.speak(utterance);

                return utterance;
            }

            stop() {
                if (speechSynthesis.speaking || speechSynthesis.pending) {
                    speechSynthesis.cancel();
                }
                this.currentUtterance = null;
                this.hideAudioIndicator();
            }

            toggle() {
                this.isEnabled = !this.isEnabled;
                if (!this.isEnabled) {
                    this.stop();
                }
                return this.isEnabled;
            }

            setEnabled(enabled) {
                this.isEnabled = enabled;
                if (!enabled) {
                    this.stop();
                }
            }

            showAudioIndicator() {
                const indicator = document.getElementById('audio-indicator');
                if (indicator) {
                    indicator.style.opacity = '1';
                    indicator.style.transform = 'translateX(0)';
                }
            }

            hideAudioIndicator() {
                const indicator = document.getElementById('audio-indicator');
                if (indicator) {
                    indicator.style.opacity = '0';
                    indicator.style.transform = 'translateX(100px)';
                }
            }
        }

        // Initialize global voice system
        let humanVoice = null;

        // Variables
        let audioEnabled = true;
        let currentAudio = null;
        let voltage = 12.0;
        let current = 1.0;
        let resistance = 12.0;
        let lastChanged = 'voltage';
        let isDragging = false;
        let activeSlider = null;

        // Audio content for Ohm's Law
        const audioContent = {
            intro: "Welcome to Ohm's Law, the fundamental relationship in electrical circuits. This interactive guide will help you understand how voltage, current, and resistance work together to power our electrical world.",
            understanding: "Let's understand Ohm's Law in detail. The law states that the current flowing through a conductor is directly proportional to the voltage and inversely proportional to the resistance. This means if you increase the voltage, the current increases, and if you increase the resistance, the current decreases.",
            formula: "The Ohm's Law formula takes three forms: V equals I times R for finding voltage, I equals V divided by R for finding current, and R equals V divided by I for finding resistance. These three equations help us solve any basic circuit problem.",
            calculator: "This interactive calculator lets you explore Ohm's Law in action. Try adjusting the voltage, current, or resistance sliders to see how they affect each other. The calculator automatically updates all values based on Ohm's Law.",
            circuit: "In this circuit visualization, you can see how electrons flow through a simple circuit. The battery provides voltage, pushing electrons through the resistor. The flow speed represents the current, while the resistor controls how easily the electrons can move.",
            voltage: "Voltage is like electrical pressure, measured in volts. It's the force that pushes electrons through the circuit. Think of it as the electrical equivalent of water pressure in a pipe.",
            current: "Current is the flow rate of electrons, measured in amperes. One ampere represents one coulomb of charge flowing per second. The higher the current, the more electrons are flowing past a point each second.",
            resistance: "Resistance, measured in ohms, is how much the material opposes electron flow. Higher resistance means electrons have a harder time flowing through, like a narrow pipe restricting water flow.",
            relationships: "Watch how these quantities interact: doubling the voltage while keeping resistance constant will double the current. Similarly, doubling the resistance while maintaining the same voltage will halve the current."
        };

        let lastVoiceUpdate = 0;
        const VOICE_UPDATE_DELAY = 1000; // Minimum time between voice updates in milliseconds

        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            loadingScreen.classList.remove('active');
        }

        function initializeAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animationPlayState = 'running';
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.fade-in').forEach(el => {
                el.style.animationPlayState = 'paused';
                observer.observe(el);
            });
        }

        function initializeVoiceSystem() {
            humanVoice = new HumanisticVoice();
            
            // Set up intersection observer for auto-audio with better timing
            const audioObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && audioEnabled) {
                        const section = entry.target;
                        // Add delay to prevent rapid-fire audio changes
                        setTimeout(() => {
                            if (entry.isIntersecting) { // Double-check still in view
                                playAudioForSection(section);
                            }
                        }, 300);
                    }
                });
            }, { 
                threshold: 0.4,
                rootMargin: '0px 0px -100px 0px'
            });

            // Observe all sections that should trigger audio
            document.querySelectorAll('.concept-section, .cinematic-section').forEach(section => {
                audioObserver.observe(section);
            });
            
            // Auto-play introduction after a short delay
            setTimeout(() => {
                if (audioEnabled) {
                    humanVoice.speak(audioContent.intro);
                }
            }, 1500);
        }

        function playAudioForSection(section) {
            const sectionTitle = section.querySelector('.section-title, .section-number');
            if (!sectionTitle) return;

            const title = sectionTitle.textContent.trim();
            
            // Stop current audio instantly
            if (humanVoice) {
                humanVoice.stop();
            }

            // Brief pause to prevent audio overlap
            setTimeout(() => {
                if (!audioEnabled) return;
                
                // Play appropriate audio based on section with more specific matching
                if (title === '⚡' || title === 'Ohm\'s Law') {
                    humanVoice.speak(audioContent.intro);
                } else if (title === 'Understanding Ohm\'s Law') {
                    humanVoice.speak(audioContent.understanding);
                } else if (title === 'Interactive Ohm\'s Law Calculator') {
                    humanVoice.speak(audioContent.calculator);
                } else if (title === 'Circuit Visualization') {
                    humanVoice.speak(audioContent.circuit);
                }
            }, 200);
        }

        function speakText(text) {
            if (humanVoice && audioEnabled) {
                humanVoice.speak(text);
            }
        }

        function stopCurrentAudio() {
            if (humanVoice) {
                humanVoice.stop();
            }
        }

        function toggleAudio() {
            if (humanVoice) {
                audioEnabled = humanVoice.toggle();
                updateAudioButton();
            }
        }

        function updateAudioButton() {
            const muteBtn = document.getElementById('mute-btn');
            if (muteBtn) {
                muteBtn.classList.toggle('muted', !audioEnabled);
            }
        }

        function setupCalculator() {
            // Initialize slider positions
            updateSliderPosition('voltage', voltage, 24);
            updateSliderPosition('current', current, 5);
            updateSliderPosition('resistance', resistance, 100);
            updateDisplay();
        }

        function setupSliderInteractions() {
            // Enhanced slider interactions with drag support
            const sliders = ['voltage', 'current', 'resistance'];
            
            sliders.forEach(type => {
                const slider = document.querySelector(`.${type}-slider`);
                const thumb = document.getElementById(`${type}-thumb`);
                
                // Mouse events
                slider.addEventListener('mousedown', (e) => handleSliderStart(e, type));
                thumb.addEventListener('mousedown', (e) => {
                    e.stopPropagation();
                    handleSliderStart(e, type);
                });
                
                // Touch events for mobile
                slider.addEventListener('touchstart', (e) => handleSliderStart(e, type));
                thumb.addEventListener('touchstart', (e) => {
                    e.stopPropagation();
                    handleSliderStart(e, type);
                });
            });
            
            // Global mouse/touch move and end events
            document.addEventListener('mousemove', handleSliderMove);
            document.addEventListener('mouseup', handleSliderEnd);
            document.addEventListener('touchmove', handleSliderMove);
            document.addEventListener('touchend', handleSliderEnd);
        }

        function handleSliderStart(event, type) {
            isDragging = true;
            activeSlider = type;
            
            // Add visual feedback
            const thumb = document.getElementById(`${type}-thumb`);
            thumb.style.transform = 'scale(1.2)';
            
            // Handle initial position
            updateSliderValue(event, type);
            
            event.preventDefault();
        }

        function handleSliderMove(event) {
            if (!isDragging || !activeSlider) return;
            
            updateSliderValue(event, activeSlider);
            event.preventDefault();
        }

        function handleSliderEnd(event) {
            if (isDragging && activeSlider) {
                const thumb = document.getElementById(`${activeSlider}-thumb`);
                thumb.style.transform = 'scale(1)';
            }
            
            isDragging = false;
            activeSlider = null;
        }

        function updateSliderValue(event, type) {
            const slider = document.querySelector(`.${type}-slider`);
            const rect = slider.getBoundingClientRect();
            
            // Get position from mouse or touch
            const clientX = event.type.includes('touch') ? 
                event.touches[0]?.clientX || event.changedTouches[0]?.clientX : 
                event.clientX;
            
            const percentage = Math.max(0, Math.min(100, 
                ((clientX - rect.left) / rect.width) * 100));
            
            // Update values based on slider type
            switch(type) {
                case 'voltage':
                    voltage = (percentage / 100) * 24;
                    lastChanged = 'voltage';
                    break;
                case 'current':
                    current = (percentage / 100) * 5;
                    lastChanged = 'current';
                    break;
                case 'resistance':
                    resistance = 1 + (percentage / 100) * 99;
                    lastChanged = 'resistance';
                    break;
            }
            
            calculateOhmsLaw();
            updateDisplay();
        }

        function updateSliderPosition(type, value, max) {
            let percentage;
            switch(type) {
                case 'voltage':
                    percentage = (value / 24) * 100;
                    break;
                case 'current':
                    percentage = (value / 5) * 100;
                    break;
                case 'resistance':
                    percentage = ((value - 1) / 99) * 100;
                    break;
            }
            
            const thumb = document.getElementById(`${type}-thumb`);
            if (thumb) {
                thumb.style.left = `${Math.max(0, Math.min(100, percentage))}%`;
            }
        }

        function calculateOhmsLaw() {
            const MIN_VALUES = { voltage: 0.1, current: 0.01, resistance: 0.1 };
            const MAX_VALUES = { voltage: 24, current: 5, resistance: 100 };
            
            // Ensure minimum values to prevent division by zero
            voltage = Math.max(MIN_VALUES.voltage, voltage);
            current = Math.max(MIN_VALUES.current, current);
            resistance = Math.max(MIN_VALUES.resistance, resistance);
            
            switch(lastChanged) {
                case 'voltage':
                    current = voltage / resistance;
                    if (current > MAX_VALUES.current) {
                        current = MAX_VALUES.current;
                        resistance = voltage / current;
                    }
                    break;
                case 'current':
                    if (current === 0) current = MIN_VALUES.current;
                    resistance = voltage / current;
                    if (resistance > MAX_VALUES.resistance) {
                        resistance = MAX_VALUES.resistance;
                        voltage = current * resistance;
                    }
                    break;
                case 'resistance':
                    current = voltage / resistance;
                    if (current > MAX_VALUES.current) {
                        current = MAX_VALUES.current;
                        voltage = current * resistance;
                    }
                    break;
            }
            
            // Ensure values stay within bounds
            voltage = Math.min(MAX_VALUES.voltage, Math.max(MIN_VALUES.voltage, voltage));
            current = Math.min(MAX_VALUES.current, Math.max(MIN_VALUES.current, current));
            resistance = Math.min(MAX_VALUES.resistance, Math.max(MIN_VALUES.resistance, resistance));
        }

        function updateDisplay() {
            const power = voltage * current;
            
            // Update individual displays with better formatting
            document.getElementById('voltage-display').textContent = `${voltage.toFixed(1)} V`;
            document.getElementById('current-display').textContent = `${current.toFixed(3)} A`;
            document.getElementById('resistance-display').textContent = `${resistance.toFixed(1)} Ω`;
            
            // Update results with enhanced precision
            document.getElementById('result-voltage').textContent = `${voltage.toFixed(2)} V`;
            document.getElementById('result-current').textContent = `${current.toFixed(3)} A`;
            document.getElementById('result-resistance').textContent = `${resistance.toFixed(2)} Ω`;
            document.getElementById('result-power').textContent = `${power.toFixed(2)} W`;
            
            // Enhanced voice feedback with rate limiting
            const now = Date.now();
            if (humanVoice && audioEnabled && (now - lastVoiceUpdate > VOICE_UPDATE_DELAY)) {
                lastVoiceUpdate = now;
                let message = '';
                
                // Create context-aware messages based on what changed
                switch(lastChanged) {
                    case 'voltage':
                        message = `Voltage set to ${voltage.toFixed(1)} volts. This ${voltage > 12 ? 'higher' : 'lower'} voltage ${voltage > 12 ? 'increases' : 'decreases'} the current to ${current.toFixed(2)} amperes through ${resistance.toFixed(1)} ohms of resistance.`;
                        break;
                    case 'current':
                        message = `Current adjusted to ${current.toFixed(2)} amperes. To maintain this current through ${resistance.toFixed(1)} ohms of resistance, we need ${voltage.toFixed(1)} volts.`;
                        break;
                    case 'resistance':
                        message = `Resistance changed to ${resistance.toFixed(1)} ohms. With ${voltage.toFixed(1)} volts applied, this results in a current of ${current.toFixed(2)} amperes.`;
                        break;
                }
                
                if (message) {
                    humanVoice.speak(message);
                }
            }
            
            // Update formula used with more accurate descriptions
            let formulaUsed;
            switch(lastChanged) {
                case 'voltage': 
                    formulaUsed = current > 1 ? 'I = V ÷ R (High Current)' : 'I = V ÷ R (Low Current)';
                    break;
                case 'current': 
                    formulaUsed = resistance > 50 ? 'R = V ÷ I (High Resistance)' : 'R = V ÷ I (Low Resistance)';
                    break;
                case 'resistance': 
                    formulaUsed = voltage > 12 ? 'I = V ÷ R (High Voltage)' : 'I = V ÷ R (Low Voltage)';
                    break;
                default: 
                    formulaUsed = 'V = I × R (Standard)';
            }
            document.getElementById('formula-used').textContent = formulaUsed;
            
            // Update slider positions
            updateSliderPosition('voltage', voltage, 24);
            updateSliderPosition('current', current, 5);
            updateSliderPosition('resistance', resistance, 100);
            
            // Update circuit with enhanced visualization
            updateCircuitVisualization();
            
            // Add visual feedback for extreme values
            highlightExtremeValues();
        }

        function highlightExtremeValues() {
            const voltageControl = document.querySelector('.voltage-control');
            const currentControl = document.querySelector('.current-control');
            const resistanceControl = document.querySelector('.resistance-control');
            
            // Reset styles
            [voltageControl, currentControl, resistanceControl].forEach(control => {
                control.style.borderColor = 'rgba(74, 158, 255, 0.3)';
                control.style.boxShadow = 'none';
            });
            
            // Highlight extreme values
            if (voltage > 20) {
                voltageControl.style.borderColor = '#e74c3c';
                voltageControl.style.boxShadow = '0 0 15px rgba(231, 76, 60, 0.3)';
            }
            if (current > 4) {
                currentControl.style.borderColor = '#f39c12';
                currentControl.style.boxShadow = '0 0 15px rgba(243, 156, 18, 0.3)';
            }
            if (resistance > 80) {
                resistanceControl.style.borderColor = '#9b59b6';
                resistanceControl.style.boxShadow = '0 0 15px rgba(155, 89, 182, 0.3)';
            }
        }

        function updateCircuitVisualization() {
            const battery = document.getElementById('circuit-battery');
            const status = document.getElementById('circuit-status');
            
            // Enhanced battery display
            battery.textContent = `${voltage.toFixed(1)}V`;
            battery.style.background = voltage > 18 ? 
                'linear-gradient(90deg, #e74c3c, #c0392b)' : 
                voltage > 12 ? 
                'linear-gradient(90deg, #f39c12, #e67e22)' : 
                'linear-gradient(90deg, #2c3e50, #34495e)';
            
            // Enhanced status display
            const powerLevel = voltage * current;
            status.innerHTML = `
                <div>Current: ${current.toFixed(3)} A</div>
                <div>Power: ${powerLevel.toFixed(2)} W</div>
            `;
            
            // Enhanced current flow speed and intensity
            const baseSpeed = 2.0;
            const speedMultiplier = Math.max(0.1, Math.min(2.0, current / 2.5));
            const flowDuration = baseSpeed / speedMultiplier;
            
            document.documentElement.style.setProperty('--flow-duration', `${flowDuration}s`);
            
            // Update particle intensity based on current
            const particles = document.querySelectorAll('.current-flow');
            particles.forEach((particle, index) => {
                const intensity = Math.max(0.3, Math.min(1.0, current / 3));
                particle.style.opacity = intensity;
                particle.style.boxShadow = `0 0 ${15 * intensity}px rgba(243, 156, 18, ${0.8 * intensity})`;
            });
        }

        function explainFormula() {
            if (audioEnabled) {
                humanVoice.speak(audioContent.formula);
            }
            
            // Add visual formula explanation
            const triangle = document.querySelector('.formula-triangle');
            triangle.style.animation = 'pulse 2s ease-in-out 3';
        }

        function demonstrateOhmsLaw() {
            // Start with initial explanation
            if (audioEnabled && humanVoice) {
                humanVoice.speak("Let me demonstrate Ohm's law with three different examples. Watch how voltage, current, and resistance relate to each other in each scenario.");
            }
            
            // Demonstrate the three forms of Ohm's Law with proper speech synchronization
            const demonstrations = [
                { voltage: 12, resistance: 6, description: "12 volts across 6 ohms creates 2 amperes of current" },
                { voltage: 24, resistance: 12, description: "24 volts across 12 ohms also creates 2 amperes, showing how proportional increases maintain the same current" },
                { voltage: 6, resistance: 3, description: "6 volts across 3 ohms again produces 2 amperes, demonstrating the consistent relationship in Ohm's law" }
            ];
            
            let currentDemo = 0;
            
            function showNextDemo() {
                if (currentDemo < demonstrations.length) {
                    const demo = demonstrations[currentDemo];
                    voltage = demo.voltage;
                    resistance = demo.resistance;
                    lastChanged = 'voltage';
                    calculateOhmsLaw();
                    updateDisplay();
                    
                    if (audioEnabled && humanVoice) {
                        const utterance = humanVoice.speak(demo.description);
                        
                        // Wait for speech to complete before proceeding
                        if (utterance) {
                            utterance.onend = () => {
                                currentDemo++;
                                setTimeout(showNextDemo, 1000); // Brief pause after speech
                            };
                        } else {
                            // Fallback if speech doesn't work
                            currentDemo++;
                            setTimeout(showNextDemo, 4000);
                        }
                    } else {
                        // No audio mode - use standard timing
                        currentDemo++;
                        setTimeout(showNextDemo, 3000);
                    }
                } else {
                    // Demo complete - final explanation
                    if (audioEnabled && humanVoice) {
                        humanVoice.speak("The demonstration is complete. You can see how Ohm's law maintains the relationship: voltage equals current times resistance. Try adjusting the sliders to explore different combinations.");
                    }
                }
            }
            
            // Start the demo after initial explanation
            setTimeout(showNextDemo, 2500);
        }

        function flashCalculatorSection() {
            const calculator = document.querySelector('.ohms-calculator');
            calculator.style.background = 'rgba(74, 158, 255, 0.2)';
            calculator.style.transition = 'background 0.5s ease';
            
            setTimeout(() => {
                calculator.style.background = 'rgba(0, 0, 0, 0.3)';
            }, 500);
        }

        function resetCalculator() {
            voltage = 12.0;
            current = 1.0;
            resistance = 12.0;
            lastChanged = 'voltage';
            updateDisplay();
            
            if (audioEnabled) {
                humanVoice.speak("Calculator reset to default values: 12 volts, 1 ampere, 12 ohms.");
            }
        }

        function showCircuit() {
            if (audioEnabled) {
                humanVoice.speak(audioContent.circuit);
            }
            
            // Scroll to circuit
            document.querySelector('.circuit-demo').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
            
            setTimeout(() => {
                startCurrentFlow();
            }, 1000);
        }

        function startCurrentFlow() {
            const flows = document.querySelectorAll('.current-flow');
            flows.forEach(flow => {
                flow.style.animationPlayState = 'running';
            });
            
            // Play circuit explanation instantly
            if (audioEnabled) {
                humanVoice.speak(audioContent.circuit);
            }
            
            addExtraParticles();
        }

        function stopCurrentFlow() {
            const flows = document.querySelectorAll('.current-flow');
            flows.forEach(flow => {
                flow.style.animationPlayState = 'paused';
            });
            
            removeExtraParticles();
        }

        function addExtraParticles() {
            const circuit = document.querySelector('.circuit-demo');
            const particleCount = Math.ceil(current * 2);
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'current-flow extra-particle current-top';
                particle.style.animationDelay = `${i * 0.5}s`;
                circuit.appendChild(particle);
                
                setTimeout(() => {
                    particle.className = 'current-flow extra-particle current-right';
                }, 1000);
                setTimeout(() => {
                    particle.className = 'current-flow extra-particle current-bottom';
                }, 2000);
                setTimeout(() => {
                    particle.className = 'current-flow extra-particle current-left';
                }, 3000);
            }
        }

        function removeExtraParticles() {
            const extraParticles = document.querySelectorAll('.extra-particle');
            extraParticles.forEach(particle => particle.remove());
        }

        function toggleFlowSpeed() {
            const currentDuration = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--flow-duration'));
            const newDuration = currentDuration > 1.5 ? 0.5 : 3;
            document.documentElement.style.setProperty('--flow-duration', `${newDuration}s`);
            
            if (audioEnabled) {
                const message = newDuration < 1 ? "High speed current flow activated" : "Normal speed current flow activated";
                if (window.speechSynthesis) {
                    window.speechSynthesis.cancel();
                    humanVoice.speak(message);
                }
            }
        }

        // Enhanced preset value functions
        function setLowVoltage() {
            voltage = 3.0;
            lastChanged = 'voltage';
            calculateOhmsLaw();
            updateDisplay();
        }

        function setMediumVoltage() {
            voltage = 12.0;
            lastChanged = 'voltage';
            calculateOhmsLaw();
            updateDisplay();
        }

        function setHighVoltage() {
            voltage = 24.0;
            lastChanged = 'voltage';
            calculateOhmsLaw();
            updateDisplay();
        }

        function speakCircuitAnalysis() {
            // Play calculator explanation instantly
            if (audioEnabled) {
                humanVoice.speak(audioContent.calculator);
            }
        }

        // Legacy click functions for backward compatibility
        function adjustVoltage(event) {
            updateSliderValue(event, 'voltage');
        }

        function adjustCurrent(event) {
            updateSliderValue(event, 'current');
        }

        function adjustResistance(event) {
            updateSliderValue(event, 'resistance');
        }

        // Audio control
        document.getElementById('mute-btn')?.addEventListener('click', function() {
            toggleAudio();
        });

        // Enhanced keyboard controls
        document.addEventListener('keydown', (event) => {
            if (event.target.tagName === 'INPUT') return;
            
            switch(event.key) {
                case 'ArrowUp':
                    if (event.shiftKey) {
                        voltage = Math.min(24, voltage + 1);
                        lastChanged = 'voltage';
                    } else {
                        current = Math.min(5, current + 0.1);
                        lastChanged = 'current';
                    }
                    calculateOhmsLaw();
                    updateDisplay();
                    event.preventDefault();
                    break;
                case 'ArrowDown':
                    if (event.shiftKey) {
                        voltage = Math.max(0.1, voltage - 1);
                        lastChanged = 'voltage';
                    } else {
                        current = Math.max(0.01, current - 0.1);
                        lastChanged = 'current';
                    }
                    calculateOhmsLaw();
                    updateDisplay();
                    event.preventDefault();
                    break;
                case 'ArrowLeft':
                    resistance = Math.max(1, resistance - 5);
                    lastChanged = 'resistance';
                    calculateOhmsLaw();
                    updateDisplay();
                    event.preventDefault();
                    break;
                case 'ArrowRight':
                    resistance = Math.min(100, resistance + 5);
                    lastChanged = 'resistance';
                    calculateOhmsLaw();
                    updateDisplay();
                    event.preventDefault();
                    break;
                case 'r':
                case 'R':
                    resetCalculator();
                    break;
                case 'd':
                case 'D':
                    demonstrateOhmsLaw();
                    break;
                case 's':
                case 'S':
                    startCurrentFlow();
                    break;
            }
        });

        // Add CSS for pulse animation
        const enhancedStyle = document.createElement('style');
        enhancedStyle.textContent = `
            @keyframes pulse {
                0%, 100% { transform: scale(1); box-shadow: 0 0 20px rgba(74, 158, 255, 0.3); }
                50% { transform: scale(1.1); box-shadow: 0 0 30px rgba(74, 158, 255, 0.6); }
            }
            
            @keyframes bounce {
                0%, 100% { transform: translateX(-50%) translateY(0); }
                50% { transform: translateX(-50%) translateY(-10px); }
            }
            
            .control-thumb {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            
            .control-thumb:active {
                transform: scale(1.3);
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            }
            
            .extra-particle {
                width: 8px;
                height: 8px;
                opacity: 0.7;
            }
        `;
        document.head.appendChild(enhancedStyle);
    </script>
</body>
</html> 